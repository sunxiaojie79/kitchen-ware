{"version":3,"file":"index.js","sources":["pages/index/index.vue","pages/index/index.vue?type=page"],"sourcesContent":["<template>\n  <view class=\"container\">\n    <!-- 设备列表区域 -->\n    <view class=\"content\">\n      <view v-if=\"device.deviceName\" class=\"device-list\">\n        <view class=\"device-item\">\n          <view class=\"device-info-container\">\n            <image class=\"device-icon\" src=\"/static/global.png\"></image>\n            <view class=\"device-details\">\n              <text class=\"name-text\">{{ device.deviceName }}</text>\n            </view>\n            <view>\n              <image class=\"bluetooth-icon\" src=\"/static/WIFI.png\"></image>\n            </view>\n            <view class=\"device-actions\">\n              <button class=\"view-btn\" @click=\"viewDevice(device)\">\n                查看設備\n              </button>\n            </view>\n          </view>\n        </view>\n      </view>\n    </view>\n  </view>\n</template>\n\n<script setup>\nimport { ref, onMounted } from \"vue\";\n\nconst device = ref({});\n\n// 显示手机号输入弹框\nconst showPhoneNumberInput = () => {\n  // 获取之前保存的手机号\n  const savedPhoneNumber = uni.getStorageSync(\"userPhoneNumber\") || \"\";\n\n  uni.showModal({\n    title: \"請輸入手機號碼\",\n    editable: true,\n    placeholderText: \"請輸入手機號碼\",\n    content: savedPhoneNumber, // 将保存的手机号填入输入框\n    success: function (res) {\n      if (res.confirm) {\n        const phoneNumber = res.content;\n        // 验证手机号格式\n        if (/^1[3-9]\\d{9}$/.test(phoneNumber)) {\n          // 保存手机号\n          uni.setStorageSync(\"userPhoneNumber\", phoneNumber);\n          // 调用获取设备列表\n          getDevice(phoneNumber);\n        } else {\n          uni.showToast({\n            title: \"請輸入正確的手機號碼\",\n            icon: \"none\",\n          });\n          // 重新显示输入框\n          setTimeout(() => {\n            showPhoneNumberInput();\n          }, 1500);\n        }\n      } else {\n        // 用户点击取消，提示必须输入手机号\n        uni.showToast({\n          title: \"必須輸入手機號碼\",\n          icon: \"none\",\n        });\n        // 重新显示输入框\n        setTimeout(() => {\n          showPhoneNumberInput();\n        }, 1500);\n      }\n    },\n  });\n};\n\n// 页面加载时执行\nonMounted(() => {\n  showPhoneNumberInput();\n});\n\n// getDevice 方法保持不变，但确保使用传入的 phoneNumber 参数\nconst getDevice = async (phoneNumber) => {\n  if (!phoneNumber) {\n    uni.showToast({\n      title: \"手機號碼不能為空\",\n      icon: \"none\",\n    });\n    return;\n  }\n\n  try {\n    const res = await uni.request({\n      url: `http://47.83.19.236:80/prod-api/device/getDeviceByPhoneNumber/${phoneNumber}`,\n      method: \"GET\",\n      header: {\n        \"Content-Type\": \"application/json\",\n      },\n    });\n    if (res.data.code === 200) {\n      if (res.data.data) {\n        device.value = res.data.data;\n      } else {\n        uni.showToast({\n          title: \"未獲取到設備\",\n          icon: \"none\",\n        });\n      }\n      console.log(222, device.value);\n    } else {\n      uni.showToast({\n        title: \"獲取設備失敗\",\n        icon: \"none\",\n      });\n    }\n  } catch (error) {\n    console.error(\"獲取設備錯誤:\", error);\n    uni.showToast({\n      title: \"網絡請求失敗\",\n      icon: \"none\",\n    });\n  }\n};\n\n// 查看设备详情\nconst viewDevice = (device) => {\n  uni.navigateTo({\n    url: `/pages/device-info/index?deviceName=${encodeURIComponent(\n      device.deviceName\n    )}&productKey=${encodeURIComponent(\n      device.productKey\n    )}&deviceSecret=${encodeURIComponent(device.deviceSecret)}`,\n  });\n};\n</script>\n\n<style>\n.container {\n  background-color: #000;\n  min-height: 100vh;\n  padding: 20rpx;\n}\n\n.content {\n  display: flex;\n  flex-direction: column;\n}\n\n.device-list {\n  flex: 1;\n}\n\n.device-item {\n  background-color: #1a1a1a;\n  border-radius: 10rpx;\n  margin-bottom: 20rpx;\n  padding: 20rpx;\n}\n\n.device-icon {\n  width: 80rpx;\n  height: 80rpx;\n}\n\n.connection-status {\n  margin-left: auto;\n  color: #fff;\n}\n\n.device-details {\n  gap: 10rpx;\n}\n.device-info-container {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 0 20rpx;\n}\n\n.name-text {\n  width: 100%;\n  text-align: center;\n  font-size: 32rpx;\n  color: #fff;\n}\n.connection-text {\n  color: #fff;\n  font-size: 28rpx;\n}\n\n.device-actions {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 20rpx;\n}\n\n.bluetooth-icon {\n  width: 40rpx;\n  height: 40rpx;\n}\n\n.view-btn {\n  background-color: #2467b0;\n  color: #fff;\n  font-size: 24rpx;\n  padding: 2rpx 10rpx;\n  border-radius: 6rpx;\n  min-width: 120rpx;\n}\n\n.add-device {\n  margin-top: 20rpx;\n}\n\n.add-btn {\n  background-color: #1a1a1a;\n  color: #fff;\n  width: 100%;\n  height: 80rpx;\n  line-height: 80rpx;\n  text-align: center;\n  border-radius: 10rpx;\n  font-size: 32rpx;\n  margin-bottom: 20rpx;\n}\n</style>\n","import MiniProgramPage from '/Users/sunjie/Desktop/my-project/kitchen-ware/pages/index/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","uni","onMounted","device","MiniProgramPage"],"mappings":";;;;;;AA6BA,UAAM,SAASA,cAAAA,IAAI,CAAA,CAAE;AAGrB,UAAM,uBAAuB,MAAM;AAEjC,YAAM,mBAAmBC,cAAG,MAAC,eAAe,iBAAiB,KAAK;AAElEA,oBAAAA,MAAI,UAAU;AAAA,QACZ,OAAO;AAAA,QACP,UAAU;AAAA,QACV,iBAAiB;AAAA,QACjB,SAAS;AAAA;AAAA,QACT,SAAS,SAAU,KAAK;AACtB,cAAI,IAAI,SAAS;AACf,kBAAM,cAAc,IAAI;AAExB,gBAAI,gBAAgB,KAAK,WAAW,GAAG;AAErCA,4BAAAA,MAAI,eAAe,mBAAmB,WAAW;AAEjD,wBAAU,WAAW;AAAA,YAC/B,OAAe;AACLA,4BAAAA,MAAI,UAAU;AAAA,gBACZ,OAAO;AAAA,gBACP,MAAM;AAAA,cAClB,CAAW;AAED,yBAAW,MAAM;AACf;cACD,GAAE,IAAI;AAAA,YACR;AAAA,UACT,OAAa;AAELA,0BAAAA,MAAI,UAAU;AAAA,cACZ,OAAO;AAAA,cACP,MAAM;AAAA,YAChB,CAAS;AAED,uBAAW,MAAM;AACf;YACD,GAAE,IAAI;AAAA,UACR;AAAA,QACF;AAAA,MACL,CAAG;AAAA,IACH;AAGAC,kBAAAA,UAAU,MAAM;AACd;IACF,CAAC;AAGD,UAAM,YAAY,OAAO,gBAAgB;AACvC,UAAI,CAAC,aAAa;AAChBD,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,QACZ,CAAK;AACD;AAAA,MACD;AAED,UAAI;AACF,cAAM,MAAM,MAAMA,cAAG,MAAC,QAAQ;AAAA,UAC5B,KAAK,iEAAiE,WAAW;AAAA,UACjF,QAAQ;AAAA,UACR,QAAQ;AAAA,YACN,gBAAgB;AAAA,UACjB;AAAA,QACP,CAAK;AACD,YAAI,IAAI,KAAK,SAAS,KAAK;AACzB,cAAI,IAAI,KAAK,MAAM;AACjB,mBAAO,QAAQ,IAAI,KAAK;AAAA,UAChC,OAAa;AACLA,0BAAAA,MAAI,UAAU;AAAA,cACZ,OAAO;AAAA,cACP,MAAM;AAAA,YAChB,CAAS;AAAA,UACF;AACDA,2EAAY,KAAK,OAAO,KAAK;AAAA,QACnC,OAAW;AACLA,wBAAAA,MAAI,UAAU;AAAA,YACZ,OAAO;AAAA,YACP,MAAM;AAAA,UACd,CAAO;AAAA,QACF;AAAA,MACF,SAAQ,OAAO;AACdA,sBAAA,MAAA,MAAA,SAAA,gCAAc,WAAW,KAAK;AAC9BA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,QACZ,CAAK;AAAA,MACF;AAAA,IACH;AAGA,UAAM,aAAa,CAACE,YAAW;AAC7BF,oBAAAA,MAAI,WAAW;AAAA,QACb,KAAK,uCAAuC;AAAA,UAC1CE,QAAO;AAAA,QACR,CAAA,eAAe;AAAA,UACdA,QAAO;AAAA,QACR,CAAA,iBAAiB,mBAAmBA,QAAO,YAAY,CAAC;AAAA,MAC7D,CAAG;AAAA,IACH;;;;;;;;;;;;;ACnIA,GAAG,WAAWC,SAAe;"}